(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{1066:function(e,t,a){"use strict";a.r(t);var i=a(1101),s=a(1090);for(var n in s)"default"!==n&&function(e){a.d(t,e,function(){return s[e]})}(n);a(1125);var r=a(2),o=Object(r.a)(s.default,i.a,i.b,!1,null,"3d61992a",null);t.default=o.exports},1088:function(e,t,a){},1089:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(a(77)),s=n(a(29));function n(e){return e&&e.__esModule?e:{default:e}}t.default={data:function(){return{oldEmail:"",props:{value:"id",label:"name",children:"children"},options:[],departs:[],data4:[],data2:[],defaultProps:{children:"children",label:"authName"},auths:[],permission:{},ids:{authIds:[],uid:"",uids:[],roleId:"",directoryIds:[]},permissionVisible:!1,permissionLoading:!1,search:{label:"realName",value:"realName"},pager:{total:1,pageSize:10,pageIndex:1,currentPage:""},pager1:{total:1,pageSize:10,pageIndex:1,currentPage:""},filters:{name:""},filters1:{departId:"",directoryId:""},state1:"",userSearch:[],abc:{a:!0,b:!0},users:[],users1:[],listLoading:!1,sels:[],sels1:[],editFormVisible:!1,editLoading:!1,addFormVisible:!1,addLoading:!1,roleVisble:!1,roleLoading:!1,roles:[],roles1:[],userRole:{assigned:[],uid:"",uids:[]},directory:{},data3:[],modelVisible:!1,modelLoading:!1,model:!1,defaultProps1:{label:"name",children:"children"},authOptions:[{value:1,label:"可读"},{value:2,label:"读/写"},{value:3,label:"管理"}]}},methods:{changeAuth:function(e,t){this.changeAuthSubmit(e,t)},modeClear:function(){console.log(111)},filterTag:function(e,t){return t.tempMode===e},cellClick:function(e,t,a,i){this.$refs.directoryAuthTable.toggleRowSelection(e,!0)},nodeRender1:function(e,t){t._self,t.node;var a=t.data;return 0===a.id?e("span",[a.name]):e("span",{class:"spanEllipsis",attrs:{title:a.name}},[e("svg",{class:"icon",attrs:{"aria-hidden":"true"}},[e("use",{attrs:{"xlink:href":"#icon-wenjianjiayigongxiang"}})]),a.name])},nodeRender:function(e,t){t._self,t.node;var a=t.data;return 0===a.id?e("span",[a.name]):e("span",{class:"spanEllipsis",attrs:{title:a.name}},[a.name])},handleChange:function(e){console.log(e),console.log(this.$refs.editDialog)},getCheckedNodes:function(){return this.$refs.tree.getCheckedNodes()},setCheckedNodes:function(e){this.$refs.tree.setCheckedNodes(e)},reset:function(){this.filters={},this.getUsers()},handleCurrentChange:function(e){this.pager.pageIndex=e,this.getUsers()},handleSizeChange:function(e){this.pager.pageSize=e,this.getUsers()},handleCurrentChange1:function(e){this.pager1.pageIndex=e,this.getUsers1()},handleSizeChange1:function(e){this.pager1.pageSize=e,this.getUsers1()},searchSelect:function(){this.getUsers()},getUsers1:function(e){var t=this;e&&(t.filters1.directoryId=e.id);var a=(0,s.default)({},t.filters1,t.pager1);t.$http({method:"post",url:"/api/user/list1",data:a}).then(function(e){t.pager1.total=e.data.total;for(var a=0;a<e.data.users.length;a++){var n=e.data.users[a].directoryAuths,r=!0,o=!1,l=void 0;try{for(var d,c=(0,i.default)(n);!(r=(d=c.next()).done);r=!0){var u=d.value;u.directory_id==t.filters1.directoryId&&(e.data.users[a]=(0,s.default)({},e.data.users[a],{tempMode:u.mode}))}}catch(e){o=!0,l=e}finally{try{!r&&c.return&&c.return()}finally{if(o)throw l}}e.data.users[a]=(0,s.default)({},e.data.users[a],{tempBool:!1})}t.users1=e.data.users}).catch(function(e){console.log(e)})},getUsers:function(e){var t=this;t.filters1.departId=e?e.id:1;var a=(0,s.default)({},t.filters1,t.pager);t.$http({method:"post",url:"/api/user/list2",data:a}).then(function(e){t.users=e.data.users,t.pager.total=e.data.total}).catch(function(e){console.log(e)})},getGroups:function(){var e=this;e.$http.post("/api/auth/list").then(function(t){e.data2=t.data.group}).catch(function(e){console.log(e)})},handleDel:function(e,t){var a=this;this.$confirm("确认删除该用户吗?","提示",{type:"warning",closeOnClickModal:!1}).then(function(){a.listLoading=!0;var e={id:t.id};a.$http({url:"/api/user/deleteGUser",method:"post",data:e}).then(function(e){a.listLoading=!1,e.data.flag?a.$message({message:"删除成功",type:"success"}):a.$message({message:"删除失败",type:"error"}),a.getUsers1()})}).catch(function(){})},handleRole:function(e,t){this.userRole.assigned=t.roles,this.userRole.uid=t.id,this.roleVisble=!0},handleRoleBatch:function(){this.userRole={assigned:[],uid:""},this.roleVisble=!0},handleAuth:function(e,t){this.ids.uid=t.id,this.permissionVisible=!0;var a=[];t.auths.forEach(function(e){return a.push(e.authId)}),console.log(a),this.authTree=a},handleAuthBatch:function(){this.permissionVisible=!0,this.authTree=[]},modelAuth:function(e,t){this.ids.uid=t.id,this.modelVisible=!0;var a=[];t.directoryAuths.forEach(function(e){return a.push(e.directoryId)}),console.log(a),this.modelTree=a},modelAuthBatch:function(){this.modelVisible=!0,this.modelTree=[]},handleAdd:function(){this.filters1.directoryId>1?(this.getUsers(),this.addFormVisible=!0,this.$nextTick(function(){this.$refs.directoryAuthTable.doLayout(),this.$refs.directoryAuthTable.nextTick(function(){Vue.nextTick(function(){})})})):this.$alert("请选择模型目录","提示",{confirmButtonText:"确定"}),this.sels=[]},handleEdit:function(e,t){this.editFormVisible=!0,this.editForm=(0,s.default)({},t),this.oldEmail=t.email},addSubmit:function(){var e=this;this.addLoading=!0;var t=[],a=!0,s=!1,n=void 0;try{for(var r,o=(0,i.default)(this.sels);!(a=(r=o.next()).done);a=!0){var l=r.value,d={uid:"",directoryId:"",mode:""};d.uid=l.id,d.directoryId=this.filters1.directoryId,d.mode=l.tempMode,t.push(d)}}catch(e){s=!0,n=e}finally{try{!a&&o.return&&o.return()}finally{if(s)throw n}}var c=t;this.$http({method:"post",url:"api/DirectoryAuth/add",data:c}).then(function(t){e.addLoading=!1,t.data.flag?e.$message({message:t.data.msg,type:"success"}):e.$message({message:t.data.msg,type:"error"}),e.addFormVisible=!1,e.getUsers1()})},changeAuthSubmit:function(e,t){var a=this,i={uid:t.id,directoryId:this.filters1.directoryId,mode:e};this.$http({url:"/api/DirectoryAuth/update",method:"post",data:i}).then(function(e){a.listLoading=!1,e.data.flag?a.$message({message:"编辑成功",type:"success"}):a.$message({message:"编辑失败",type:"error"}),t.tempBool=!t.tempBool})},selsChange:function(e){this.sels=e,console.log(e)},selsChange1:function(e){this.sels1=e,console.log(e)},batchRemove:function(){var e=this,t=[],a=!0,s=!1,n=void 0;try{for(var r,o=(0,i.default)(this.sels1);!(a=(r=o.next()).done);a=!0){var l=r.value,d={uid:"",directoryId:"",mode:""};d.uid=l.id,d.directoryId=this.filters1.directoryId,t.push(d)}}catch(e){s=!0,n=e}finally{try{!a&&o.return&&o.return()}finally{if(s)throw n}}var c=t;this.$confirm("确认删除选中记录吗？","提示",{type:"warning",closeOnClickModal:!1}).then(function(){e.listLoading=!0,e.$http({url:"/api/DirectoryAuth/delete",method:"post",data:c}).then(function(t){e.listLoading=!1,t.data.flag?e.$message({message:"删除成功",type:"success"}):e.$message({message:"删除失败",type:"error"}),e.getUsers1()})}).catch(function(){})},getDeparts:function(){var e=this;e.$http.post("api/depart/list").then(function(t){e.departs=t.data.depart,e.options=t.data.depart,e.data4=t.data.depart}).catch(function(e){console.log(e)})},getDirectoryTree:function(){var e=this;e.$http.post("api/directory/getDirectoryTree").then(function(t){e.data3=t.data.directoryTree}).catch(function(e){console.log(e)})}},mounted:function(){this.getDeparts(),this.getDirectoryTree()}}},1090:function(e,t,a){"use strict";a.r(t);var i=a(1089),s=a.n(i);for(var n in i)"default"!==n&&function(e){a.d(t,e,function(){return i[e]})}(n);t.default=s.a},1101:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"d-auth-view"},[a("div",{staticStyle:{height:"50px","margin-top":"10px","min-width":"500px"}},[a("el-form",{attrs:{inline:!0,model:e.filters}},[a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleAdd}},[e._v("新增\n          "),a("i",{staticClass:"el-icon-plus el-icon--right"})])],1)],1)],1),e._v(" "),a("hr"),e._v(" "),a("div",{staticStyle:{display:"flex",height:"inherit","flex-grow":"1"}},[a("el-tree",{ref:"tree1",staticStyle:{width:"300px","min-height":"inherit","overflow-y":"auto"},attrs:{data:e.data3,"node-key":"id","highlight-current":"",props:e.defaultProps1,"expand-on-click-node":!1,"default-expand-all":!0,"render-content":e.nodeRender1},on:{"node-click":e.getUsers1}}),e._v(" "),a("div",{staticStyle:{height:"inherit",width:"100%"}},[a("el-table",{staticClass:"tableWrapper",attrs:{data:e.users1,"highlight-current-row":"",center:"",height:"100%","row-key":"id"},on:{"selection-change":e.selsChange1}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"用户名","min-width":"120",sortable:"","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"fullName",label:"真实姓名","min-width":"120",sortable:"","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"departName",label:"部门","min-width":"120",sortable:"","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{label:"权限等级","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{staticStyle:{width:"120px"},attrs:{size:"small",placeholder:"请选择"},on:{change:function(a){e.changeAuth(a,t.row)}},model:{value:t.row.tempMode,callback:function(a){e.$set(t.row,"tempMode",a)},expression:"scope.row.tempMode"}},e._l(e.authOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))]}}])})],1)],1)],1),e._v(" "),a("div",[a("div",{staticStyle:{display:"flex",height:"40px","margin-top":"10px","margin-bottom":"10px",width:"100%","text-align":"justify","justify-content":"space-between"}},[a("div",[a("el-button",{attrs:{type:"danger",size:"small",disabled:0===this.sels1.length},on:{click:e.batchRemove}},[e._v("批量删除")])],1),e._v(" "),a("div",[a("el-pagination",{attrs:{"current-page":e.pager1.pageIndex,"page-sizes":[10,30,50,100],"page-size":e.pager1.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.pager1.total},on:{"size-change":e.handleSizeChange1,"current-change":e.handleCurrentChange1}})],1)])]),e._v(" "),e.addFormVisible?a("el-dialog",{attrs:{title:"新增",visible:e.addFormVisible,width:"80%","close-on-click-modal":!1},on:{"update:visible":function(t){e.addFormVisible=t}}},[a("hr"),e._v(" "),a("div",{staticStyle:{display:"flex","min-height":"300px"}},[a("el-tree",{ref:"tree2",staticStyle:{width:"200px"},attrs:{data:e.data4,props:e.defaultProps1,"render-content":e.nodeRender,"default-expand-all":!0,"expand-on-click-node":!1},on:{"node-click":e.getUsers}}),e._v(" "),a("el-table",{ref:"directoryAuthTable",attrs:{data:e.users,"highlight-current-row":"",center:""},on:{"selection-change":e.selsChange,"cell-click":e.cellClick}},[a("el-table-column",{attrs:{prop:"name",label:"用户名","min-width":"120",sortable:"","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"departName",label:"部门","min-width":"120",sortable:"","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{label:"权限级别",width:"500"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-radio-group",{model:{value:t.row.tempMode,callback:function(a){e.$set(t.row,"tempMode",a)},expression:"scope.row.tempMode"}},[a("el-radio",{attrs:{label:1}},[e._v("可读")]),e._v(" "),a("el-radio",{attrs:{label:2}},[e._v("读/写")]),e._v(" "),a("el-radio",{attrs:{label:3}},[e._v("管理")])],1),e._v(" "),a("el-button",{staticStyle:{"margin-left":"5px"},attrs:{size:"small",type:"text",icon:"el-icon-close"},on:{click:function(e){t.row.tempMode=0}}})]}}])})],1)],1),e._v(" "),a("div",{staticStyle:{display:"flex",height:"40px","margin-top":"10px","margin-bottom":"10px",width:"100%"}},[a("div",[a("el-pagination",{attrs:{small:"","current-page":e.pager.pageIndex,"page-sizes":[10,30,50,100],"page-size":e.pager.pageSize,layout:"total, sizes, prev, pager, next",total:e.pager.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.addFormVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.addLoading,disabled:0==this.sels.length},nativeOn:{click:function(t){return e.addSubmit(t)}}},[e._v("提交")])],1)]):e._e()],1)},s=[];a.d(t,"a",function(){return i}),a.d(t,"b",function(){return s})},1125:function(e,t,a){"use strict";var i=a(1088);a.n(i).a}}]);
//# sourceMappingURL=../../map/5.js.map