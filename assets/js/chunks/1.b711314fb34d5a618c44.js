(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{1062:function(e,t,i){"use strict";i.r(t);var s=i(1106),a=i(1078);for(var o in a)"default"!==o&&function(e){i.d(t,e,function(){return a[e]})}(o);i(1114);var l=i(2),n=Object(l.a)(a.default,s.a,s.b,!1,null,"50c557e3",null);t.default=n.exports},1073:function(e,t,i){},1074:function(e,t,i){},1075:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={data:function(){return{data2:[],defaultProps:{children:"children",label:"label"},treeLoading:!1,checkedNodes:[],names:[],namesNum:0}},props:["reset"],methods:{check:function(e,t,i){console.log(this.namesNum),console.log(e),t&&e.leaf?(this.namesNum++,console.log(this.namesNum)):!t&&e.leaf&&(this.namesNum--,console.log(this.namesNum))},affirm:function(){this.names=[],this.checkedNodes=this.$refs.tree.getCheckedNodes();for(var e=0;e<this.checkedNodes.length;e++)this.checkedNodes[e].disabled||this.names.push(this.checkedNodes[e].label);this.$emit("affirmName",this.names[0]),this.reset=!1},getData2:function(){var e=this;this.func.ajaxPost("/api/userTree/query",{},function(t){!0===t.data.flag&&(e.data2=t.data.users.children)})}},watch:{reset:function(e,t){console.log(e+"  "+t),!t&&e&&this.$refs.tree.setCheckedKeys([])}},mounted:function(){this.getData2(),console.log("开始加载人员树")}}},1076:function(e,t,i){"use strict";i.r(t);var s=i(1075),a=i.n(s);for(var o in s)"default"!==o&&function(e){i.d(t,e,function(){return s[e]})}(o);t.default=a.a},1077:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=o(i(29)),a=o(i(1117));function o(e){return e&&e.__esModule?e:{default:e}}t.default={components:{userTree:a.default},data:function(){var e=function(e,t,i){var s=new RegExp("^[ a-zA-Z0-9_一-龥]+$");console.log(t),t?s.test(t)?t.length>20?i(new Error("节点名不得超过20个字符")):t.trim()?i():i(new Error("不能全为空格")):i(new Error("只允许输入中文、英文、数字、下划线及空格")):i(new Error("请输入节点名"))};return{tempateId:0,items:[],addItemsDialog:{reviewNodeName:"",description:"",userName:""},editItemsDialog:{reviewNodeName:"",description:"",userName:""},chooseCheckorDialog:{userName:""},sels:[],addItemsDialogVisible:!1,editItemsDialogVisible:!1,sequence:0,chooseNameVisible:!1,userNames:[],value2:[],data2:[],userName:"",submitAllLoading:!1,nodesLoading:!1,userNamesLoading:!1,addFormRules:{reviewNodeName:[{required:!0,validator:e,trigger:"blur"}]},editFormRules:{reviewNodeName:[{required:!0,validator:e,trigger:"blur"}]}}},created:function(){this.templateId=sessionStorage.getItem("templateId")},methods:{affirmName1:function(e){this.chooseNameVisible=!1,this.addItemsDialog.userName=e,this.editItemsDialog.userName=e},query:function(){var e=this;this.func.ajaxPost("/api/user/query",{},function(t){if(e.userNamesLoading=!0,1==t.data.flag){for(var i=t.data.users,s=0;s<i.length;s++)e.userNames.push(i[s].name);e.userNamesLoading=!1}})},submitOne:function(){var e=this;this.$refs.addForm.validate(function(t){if(t){var i=e.addItemsDialog.reviewNodeName.indexOf(","),s=",".indexOf(e.addItemsDialog.description),a=",".indexOf(e.addItemsDialog.userName),o=e.items.length+1;e.func.isNull(e.addItemsDialog.userName)?e.$message({message:"人员不能为空"}):i>0||s>0||a>0?e.$message({message:"配置中不能含有英文逗号，请重新输入"}):(e.func.isNull(e.addItemsDialog.reviewNodeName)&&(e.addItemsDialog.reviewNodeName="节点"+o),e.func.isNull(e.addItemsDialog.description)&&(e.addItemsDialog.description="这是节点"+o),e.items.push(e.addItemsDialog),e.addItemsDialogVisible=!1)}})},submitAll:function(){var e=this;0===this.items.length?this.$message({type:"info",message:"未配置不能提交"}):this.$confirm("确认提交吗？","提示",{type:"info ",closeOnClickModal:!1}).then(function(){e.submitAllLoading=!0;for(var t=[],i=[],s=[],a=0;a<e.items.length;a++)t.push(e.func.isNull(e.items[a].reviewNodeName)?"defaultName":e.items[a].reviewNodeName),i.push(e.func.isNull(e.items[a].description)?"defaultDescription":e.items[a].description),s.push(e.items[a].userName);e.func.ajaxPost("/api/reviewNode/batchAdd",{reviewNodeName:t.join(","),description:i.join(","),userName:s.join(","),templateId:e.templateId},function(t){1==t.data.flag&&(e.submitAllLoading=!1,e.$message({message:"提交成功！",type:"success"}),e.redirect())})})},redirect:function(){sessionStorage.removeItem("templateId"),this.$router.push({path:"/management/template"})},cancelAll:function(){this.redirect()},selsChange:function(e){this.sels=e},handleEdit:function(e){this.editItemsDialogVisible=!0,this.sequence=this.items.indexOf(e),this.editItemsDialog=(0,s.default)({},e)},handleAdd:function(){this.addItemsDialogVisible=!0,this.addItemsDialog={reviewNodeName:"",description:"",userName:""}},submitEdit:function(){var e=this;this.$refs.editForm.validate(function(t){t&&(e.func.isNull(e.editItemsDialog.reviewNodeName)&&(e.editItemsDialog.reviewNodeName="节点"+(e.sequence+1)),e.func.isNull(e.editItemsDialog.description)&&(e.editItemsDialog.description="这是节点"+(e.sequence+1)),e.items.splice(e.sequence,1,e.editItemsDialog),e.editItemsDialogVisible=!1)})},chooseName:function(){this.chooseNameVisible=!0,this.reset=!1,this.reset=!0},getUserNames:function(){},getData2:function(){var e=this;this.userNames.forEach(function(t,i){e.data2.push({label:t,key:i})})},submitName:function(){if(1!=this.value2.length)this.$message({message:"选择的人员数应该是一个"});else{var e=this.value2[0];this.addItemsDialog.userName=this.data2[e].label,this.editItemsDialog.userName=this.data2[e].label,this.chooseNameVisible=!1}},remove:function(e){var t=this;this.$confirm("确认要删除吗？","提示",{type:"warning",closeOnClickModal:!1}).then(function(){var i=t.items.indexOf(e);t.items.splice(i,1)})},getNodes:function(){var e=this;this.nodesLoading=!0;this.func.ajaxPost("api/reviewNode/queryReviewNode",{templateId:this.templateId},function(t){1==t.data.flag&&(e.items=t.data.nodes,e.nodesLoading=!1)})}},mounted:function(){this.getUserNames(),this.getData2(),this.getNodes()}}},1078:function(e,t,i){"use strict";i.r(t);var s=i(1077),a=i.n(s);for(var o in s)"default"!==o&&function(e){i.d(t,e,function(){return s[e]})}(o);t.default=a.a},1100:function(e,t,i){"use strict";var s=function(){var e=this.$createElement,t=this._self._c||e;return t("section",[t("el-row",[t("el-tree",{ref:"tree",attrs:{data:this.data2,"show-checkbox":"","default-expand-all":"","node-key":"label","highlight-current":"",props:this.defaultProps},on:{"check-change":this.check}})],1),this._v(" "),t("el-row",[t("el-button",{staticStyle:{float:"right","margin-bottom":"10px"},attrs:{type:"primary",disabled:1!==this.namesNum},on:{click:this.affirm}},[this._v("确定")])],1)],1)},a=[];i.d(t,"a",function(){return s}),i.d(t,"b",function(){return a})},1106:function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("section",[i("el-form",{staticStyle:{height:"45px"},attrs:{inline:!0}},[i("el-form-item",[i("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleAdd}},[e._v("新增")])],1),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary",size:"small",loading:e.submitAllLoading},on:{click:e.submitAll}},[e._v("完成")])],1),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.cancelAll}},[e._v("取消配置")])],1)],1),e._v(" "),i("hr"),e._v(" "),i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.items,"highlight-current-row":"",loading:e.nodesLoading},on:{"selection-change":e.selsChange}},[i("el-table-column",{attrs:{type:"selection",width:"50"}}),e._v(" "),i("el-table-column",{attrs:{type:"index",label:"节点次序",width:"120"}}),e._v(" "),i("el-table-column",{attrs:{prop:"reviewNodeName",label:"节点名","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticClass:"tableEllipsis",staticStyle:{"min-width":"120px"},attrs:{title:t.row.reviewNodeName}},[e._v(e._s(t.row.reviewNodeName))])]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"description",label:"节点描述","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticClass:"tableEllipsis",staticStyle:{"min-width":"120px"},attrs:{title:t.row.description}},[e._v(e._s(t.row.description))])]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"userName",label:"审核者","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticClass:"tableEllipsis",staticStyle:{"min-width":"120px"},attrs:{title:t.row.userName}},[e._v(e._s(t.row.userName))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"操作","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"small"},on:{click:function(i){e.handleEdit(t.row)}}},[e._v("修改")]),e._v(" "),i("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(i){e.remove(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),i("el-dialog",{attrs:{title:"配置人员",visible:e.addItemsDialogVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.addItemsDialogVisible=t}},model:{value:e.addItemsDialogVisible,callback:function(t){e.addItemsDialogVisible=t},expression:"addItemsDialogVisible"}},[i("el-form",{ref:"addForm",attrs:{model:e.addItemsDialog,"label-width":"80px",rules:e.addFormRules}},[i("el-form-item",{attrs:{label:"节点名",prop:"reviewNodeName"}},[i("el-input",{model:{value:e.addItemsDialog.reviewNodeName,callback:function(t){e.$set(e.addItemsDialog,"reviewNodeName",t)},expression:"addItemsDialog.reviewNodeName"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"节点描述",prop:"description"}},[i("el-input",{model:{value:e.addItemsDialog.description,callback:function(t){e.$set(e.addItemsDialog,"description",t)},expression:"addItemsDialog.description"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"审核者",prop:"userName",rules:[{required:!0,message:"请选择审核者",trigger:"blur"}]}},[i("div",{staticStyle:{display:"flex"}},[i("el-input",{staticStyle:{"margin-right":"10px"},attrs:{disabled:!0},model:{value:e.addItemsDialog.userName,callback:function(t){e.$set(e.addItemsDialog,"userName",t)},expression:"addItemsDialog.userName"}}),e._v(" "),i("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.chooseName(t)}}},[e._v("选择审核者")])],1)])],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{nativeOn:{click:function(t){e.addItemsDialogVisible=!1}}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submitOne(t)}}},[e._v("确定")])],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"配置人员",visible:e.editItemsDialogVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.editItemsDialogVisible=t}},model:{value:e.editItemsDialogVisible,callback:function(t){e.editItemsDialogVisible=t},expression:"editItemsDialogVisible"}},[i("el-form",{ref:"editForm",attrs:{model:e.editItemsDialog,"label-width":"80px",rules:e.editFormRules}},[i("el-form-item",{attrs:{label:"节点名",prop:"reviewNodeName"}},[i("el-input",{model:{value:e.editItemsDialog.reviewNodeName,callback:function(t){e.$set(e.editItemsDialog,"reviewNodeName",t)},expression:"editItemsDialog.reviewNodeName"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"节点描述",prop:"description"}},[i("el-input",{model:{value:e.editItemsDialog.description,callback:function(t){e.$set(e.editItemsDialog,"description",t)},expression:"editItemsDialog.description"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"审核者",prop:"userName"}},[i("div",{staticStyle:{display:"flex"}},[i("el-input",{staticStyle:{"margin-right":"10px"},attrs:{disabled:!0},model:{value:e.editItemsDialog.userName,callback:function(t){e.$set(e.editItemsDialog,"userName",t)},expression:"editItemsDialog.userName"}}),e._v(" "),i("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.chooseName(t)}}},[e._v("选择审核者")])],1)])],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{nativeOn:{click:function(t){e.editItemsDialogVisible=!1}}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},nativeOn:{click:function(t){return e.submitEdit(t)}}},[e._v("确定")])],1)],1),e._v(" "),i("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.userNamesLoading,expression:"userNamesLoading"}],attrs:{title:"选择人员",visible:e.chooseNameVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.chooseNameVisible=t}},model:{value:e.chooseNameVisible,callback:function(t){e.chooseNameVisible=t},expression:"chooseNameVisible"}},[[i("user-tree",{attrs:{reset:e.chooseNameVisible},on:{affirmName:e.affirmName1}})]],2)],1)},a=[];i.d(t,"a",function(){return s}),i.d(t,"b",function(){return a})},1114:function(e,t,i){"use strict";var s=i(1073);i.n(s).a},1116:function(e,t,i){"use strict";var s=i(1074);i.n(s).a},1117:function(e,t,i){"use strict";i.r(t);var s=i(1100),a=i(1076);for(var o in a)"default"!==o&&function(e){i.d(t,e,function(){return a[e]})}(o);i(1116);var l=i(2),n=Object(l.a)(a.default,s.a,s.b,!1,null,null,null);t.default=n.exports}}]);
//# sourceMappingURL=../../map/1.js.map