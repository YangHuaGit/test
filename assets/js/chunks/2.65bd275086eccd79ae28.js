(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{1063:function(e,t,a){"use strict";a.r(t);var l=a(1105),i=a(1081);for(var s in i)"default"!==s&&function(e){a.d(t,e,function(){return i[e]})}(s);a(1119);var n=a(2),o=Object(n.a)(i.default,l.a,l.b,!1,null,"00056174",null);t.default=o.exports},1079:function(e,t,a){},1080:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=s(a(77)),i=s(a(29));function s(e){return e&&e.__esModule?e:{default:e}}t.default={data:function(){return{path:"/views/review/template",filters:{name:""},addFormVisible:!1,page:1,pageSize:10,pageSizes:[10,20,30],listLoading:!1,templates:[],pages:0,total:0,addTemplate:{templateName:"",description:"",defaultTemplate:!1},sels:[],addLoading:!1,addFormRules:{templateName:[{required:!0,validator:function(e,t,a){var l=new RegExp("^[ a-zA-Z0-9_一-龥]+$");console.log(t),t?l.test(t)?t.length>20?a(new Error("模板名不得超过20个字符")):t.trim()?a():a(new Error("不能全为空格")):a(new Error("只允许输入中文、英文、数字、下划线及空格")):a(new Error("请输入模板名"))},trigger:"blur"}]}}},methods:{format:function(e,t){return 0==e.alreadyConfig?"否":"是"},formatDefault:function(e,t){return 0==e.defaultTemplate?"否":"是"},getTemplates:function(e){var t=this,a={page:this.page,rows:this.pageSize,templateName:this.filters.name};this.listLoading=!0;this.func.ajaxPost("/api/reviewFlowTemplate/queryReviewFlowTemplateByName",a,function(a){if(t.templates=a.data.records,t.pages=a.data.pages,t.total=a.data.total,t.listLoading=!1,e){var l=t.templates[t.templates.length-1];t.handleEdit(l)}})},handleAdd:function(){this.addFormVisible=!0,this.addTemplate={templateName:"",description:"",defaultTemplate:!1}},selsChange:function(e){this.sels=e},handleEdit:function(e){this.$store.commit("setCurPage",{path:this.path,page:this.page}),sessionStorage.setItem("templateId",e.templateId),this.$router.push("/setCheckors")},batchRemove:function(){var e=this,t=this.sels.map(function(e){return e.templateId}).join(",").toString();this.$confirm("确认删除选中记录吗？","提示",{type:"warning",closeOnClickModal:!1}).then(function(){e.listLoading=!0;var a={templateIds:t};e.func.ajaxPost("/api/reviewFlowTemplate/deleteByTemplateId",a,function(t){1==t.data.flag&&(e.$message({message:"删除成功",type:"success"}),e.listLoading=!1,e.getTemplates(!1))})})},handleCurrentChange:function(e){this.page=e,this.getTemplates(!1)},handleSizeChange:function(e){this.pageSize=e,this.getTemplates(!1)},addSubmit:function(){var e=this;this.$refs.addForm.validate(function(t){if(t){var a=(0,i.default)({},e.addTemplate);if(e.isRepeatedTemplate(a))e.$message({message:"模板名不能重复"});else{e.addLoading=!0;var l="/api/reviewFlowTemplate/addReviewFlowTemplate";a.assure="no",e.func.ajaxPost(l,a,function(t){200==t.data.code&&(t.data.changeDefault?e.$confirm("已经存在默认模板，要替换吗？","提示",{type:"info",closeOnClickModal:!1}).then(function(){a.assure="yes",e.func.ajaxPost(l,a,function(t){200!==t.data.code||t.data.changeDefault||(e.addLoading=!1,e.addFormVisible=!1,e.$message({message:"提交成功！",type:"success"}),e.addTemplate.defaultTemplate?e.getTemplates(!0):e.getTemplates(!1))})}).catch(function(){e.addLoading=!1}):(e.addLoading=!1,e.addFormVisible=!1,e.$message({message:"提交成功！",type:"success"}),e.addTemplate.defaultTemplate?e.getTemplates(!0):e.getTemplates(!1)))})}}})},isRepeatedTemplate:function(e){var t=!1,a=!0,i=!1,s=void 0;try{for(var n,o=(0,l.default)(this.templates);!(a=(n=o.next()).done);a=!0){if(n.value.templateName===e.templateName){t=!0;break}}}catch(e){i=!0,s=e}finally{try{!a&&o.return&&o.return()}finally{if(i)throw s}}return t},remove:function(e,t){var a=this;this.$confirm("确认删除选中记录吗？","提示",{type:"warning",closeOnClickModal:!1}).then(function(){a.listLoading=!0;var e={templateIds:t.templateId};a.func.ajaxPost("/api/reviewFlowTemplate/deleteByTemplateId",e,function(e){1==e.data.flag&&(a.$message({message:"删除成功",type:"success"}),a.listLoading=!1,a.getTemplates(!1))})})},setDefault:function(e,t){var a=this;if(t.alreadyConfig){var l={templateId:t.templateId},i="/api/reviewFlowTemplate/setDefault";l.assure="no",this.func.ajaxPost(i,l,function(e){200===e.data.code&&(e.data.reminder?a.$confirm("已经存在默认模板，要替换吗？","提示",{type:"info",closeOnClickModal:!1}).then(function(){l.assure="yes",a.func.ajaxPost(i,l,function(e){200===e.data.code&&(a.$message({message:"设置成功",type:"success"}),a.listLoading=!1,a.getTemplates(!1))})}):(a.$message({message:"设置成功",type:"success"}),a.listLoading=!1,a.getTemplates(!1)))})}else this.$message({message:"未配置人员，不能设为默认模板"})}},mounted:function(){this.page=this.func.freshPage(this.path,this.page),this.getTemplates(!1)}}},1081:function(e,t,a){"use strict";a.r(t);var l=a(1080),i=a.n(l);for(var s in l)"default"!==s&&function(e){a.d(t,e,function(){return l[e]})}(s);t.default=i.a},1105:function(e,t,a){"use strict";var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("el-col",{staticStyle:{"padding-bottom":"0px","margin-top":"10px"},attrs:{span:24}},[a("el-form",{attrs:{inline:!0,model:e.filters},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"模板名"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.getTemplates(!1)}},model:{value:e.filters.name,callback:function(t){e.$set(e.filters,"name",t)},expression:"filters.name"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.getTemplates(!1)}}},[e._v("查询\n\t\t\t\t\t"),a("i",{staticClass:"el-icon-search el-icon--right"})])],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleAdd}},[e._v("新增\n\t\t\t\t\t"),a("i",{staticClass:"el-icon-plus el-icon--right"})])],1)],1)],1),e._v(" "),a("hr"),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.templates,"highlight-current-row":""},on:{"selection-change":e.selsChange}},[a("el-table-column",{attrs:{type:"selection",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"templateName",label:"模板名",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"tableEllipsis",staticStyle:{"min-width":"120px"},attrs:{title:t.row.templateName}},[e._v(e._s(t.row.templateName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"alreadyConfig",label:"是否配置",width:"120",formatter:e.format}}),e._v(" "),a("el-table-column",{attrs:{prop:"description",label:"模板描述",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"tableEllipsis",staticStyle:{"min-width":"120px"},attrs:{title:t.row.description}},[e._v(e._s(t.row.description))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"defaultTemplate",label:"是否为默认模板",width:"120",formatter:e.formatDefault}}),e._v(" "),a("el-table-column",{attrs:{prop:"lastUpdateTime",label:"最后修改时间","min-width":"120"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"small"},on:{click:function(a){e.setDefault(t.$index,t.row)}}},[e._v("设为默认")]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:function(a){e.handleEdit(t.row)}}},[e._v("配置")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){e.remove(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-col",{staticStyle:{"margin-top":"10px"},attrs:{span:24}},[a("el-button",{attrs:{type:"danger",size:"small",disabled:0===this.sels.length},on:{click:e.batchRemove}},[e._v("批量删除")]),e._v(" "),a("el-pagination",{staticStyle:{float:"right"},attrs:{layout:"total,sizes,prev, pager, next",total:e.total,"page-sizes":e.pageSizes,"page-size":e.pageSize},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:"新增",visible:e.addFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.addFormVisible=t}},model:{value:e.addFormVisible,callback:function(t){e.addFormVisible=t},expression:"addFormVisible"}},[a("el-form",{ref:"addForm",attrs:{model:e.addTemplate,"label-width":"120px",rules:e.addFormRules}},[a("el-form-item",{attrs:{label:"模板名",prop:"templateName"}},[a("el-input",{model:{value:e.addTemplate.templateName,callback:function(t){e.$set(e.addTemplate,"templateName",t)},expression:"addTemplate.templateName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"模板描述",prop:"description"}},[a("el-input",{model:{value:e.addTemplate.description,callback:function(t){e.$set(e.addTemplate,"description",t)},expression:"addTemplate.description"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"是否为默认模板"}},[a("el-radio-group",{model:{value:e.addTemplate.defaultTemplate,callback:function(t){e.$set(e.addTemplate,"defaultTemplate",t)},expression:"addTemplate.defaultTemplate"}},[a("el-radio",{staticClass:"radio",attrs:{label:!0}},[e._v("是")]),e._v(" "),a("el-radio",{staticClass:"radio",attrs:{label:!1}},[e._v("否")])],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.addFormVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.addLoading},nativeOn:{click:function(t){return e.addSubmit(t)}}},[e._v("提交")])],1)],1)],1)},i=[];a.d(t,"a",function(){return l}),a.d(t,"b",function(){return i})},1119:function(e,t,a){"use strict";var l=a(1079);a.n(l).a}}]);
//# sourceMappingURL=../../map/2.js.map